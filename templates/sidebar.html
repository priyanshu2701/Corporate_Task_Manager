<button class="mobile-menu-btn" onclick="toggleMobileMenu()">
  <i class="fas fa-bars"></i>
</button>

<div class="overlay" onclick="toggleMobileMenu()"></div>

<nav class="sidebar" id="sidebar">
  <div class="logo">CSism Technologies</div>

  <div class="nav-section">

    <!-- DASHBOARD -->
    {% if session['user_role'] == 'superadmin' %}
      <a href="{{ url_for('superadmin_dashboard') }}" 
         class="nav-link1 {% if request.endpoint == 'superadmin_dashboard' %}active{% endif %}">
    {% elif session['user_role'] == 'head' %}
      <a href="{{ url_for('admin_dashboard') }}" 
         class="nav-link1 {% if request.endpoint == 'admin_dashboard' %}active{% endif %}">
    {% elif session['user_role'] in  ('employee','intern') %}
      <a href="{{ url_for('employee_dashboard') }}" 
         class="nav-link1 {% if request.endpoint == 'employee_dashboard' %}active{% endif %}">
    {% endif %}
        <i class="fas fa-chart-line"></i>
        <span>Dashboard</span>
    </a>


    <!-- ADD NEW USER -->
   {% if session['user_role'] in ['superadmin', 'head'] %}
    <a  
        href="{% if session['user_role'] == 'superadmin' %}
                 {{ url_for('superadmin_adduser') }}
               {% else %}
                 {{ url_for('admin_adduser') }}
               {% endif %}"
        class="nav-link1 
               {% if session['user_role'] == 'superadmin' and request.endpoint == 'superadmin_adduser' %}
                  active
               {% elif session['user_role'] == 'head' and request.endpoint == 'admin_adduser' %}
                  active
               {% endif %}"
    >
        <i class="fas fa-user-plus"></i>
        <span>Add New User</span>
    </a>
{% endif %}

       

    <div class="nav-divider"></div>


    <!-- PROJECTS DROPDOWN -->
    <div class="side-dropdown 
      {% if request.endpoint in [
        'superadmin_createproject','superadmin_viewprojects',
        'admin_createproject','admin_viewprojects','employee_ongoing_projects'
      ] %}active{% endif %}"
      onclick="toggleSideDropdown(this)">

      <a href="#" class="nav-link1 side-dropdown-toggle">
        <div style="display:flex; align-items:center;">
          <i class="fas fa-folder-plus"></i>
          <span>Projects</span>
        </div>
      </a>

      <div class="side-dropdown-menu">

        {% if session['user_role'] == 'superadmin' %}
          <a class="side-dropdown-item 
            {% if request.endpoint == 'superadmin_createproject' %}active{% endif %}"
             href="{{ url_for('superadmin_createproject') }}">
            Create New Project
          </a>

          <a class="side-dropdown-item 
            {% if request.endpoint == 'superadmin_viewprojects' %}active{% endif %}"
             href="{{ url_for('superadmin_viewprojects') }}">
            View All Projects
          </a>

        {% elif session['user_role'] == 'head' %}

          <a class="side-dropdown-item 
            {% if request.endpoint == 'admin_createproject' %}active{% endif %}"
             href="{{ url_for('admin_createproject') }}">
            Create New Project
          </a>

          <a class="side-dropdown-item 
            {% if request.endpoint == 'admin_viewprojects' %}active{% endif %}"
             href="{{ url_for('admin_viewprojects') }}">
            View All Projects
          </a>

           {% elif session['user_role'] in ['employee', 'intern'] %}

            <a class="side-dropdown-item 
              {% if request.endpoint == 'employee_ongoing_projects' %}active{% endif %}"
              href="{{ url_for('employee_ongoing_projects') }}">
              My Projects
            </a>


        {% endif %}
      </div>
    </div>



    <!-- TASKS DROPDOWN -->
    <div class="side-dropdown 
      {% if request.endpoint in [
        'superadmin_createtask','superadmin_viewtasks','superadmin_submitted_tasks',
        'admin_createtask','admin_viewtasks','admin_submit_task','admin_submitted_tasks','employee_submitted_tasks','employee_submit_task','employee_assigned_tasks','employee_createtask'
      ] %}active{% endif %}"
      onclick="toggleSideDropdown(this)">

      <a href="#" class="nav-link1 side-dropdown-toggle">
        <div style="display:flex; align-items:center;">
          <i class="fas fa-tasks"></i>
          <span>Tasks</span>
        </div>
      </a>

      <div class="side-dropdown-menu">

        {% if session['user_role'] == 'superadmin' %}

          <a class="side-dropdown-item 
            {% if request.endpoint == 'superadmin_createtask' %}active{% endif %}"
             href="{{ url_for('superadmin_createtask') }}">Create Task</a>

          <a class="side-dropdown-item 
            {% if request.endpoint == 'superadmin_viewtasks' %}active{% endif %}"
             href="{{ url_for('superadmin_viewtasks') }}">View All Tasks</a>

          <a class="side-dropdown-item 
            {% if request.endpoint == 'superadmin_submitted_tasks' %}active{% endif %}"
             href="{{ url_for('superadmin_submitted_tasks') }}">Submitted Tasks</a>

        {% elif session['user_role'] == 'head' %}

          <a class="side-dropdown-item 
            {% if request.endpoint == 'admin_createtask' %}active{% endif %}"
             href="{{ url_for('admin_createtask') }}">Create Task</a>

          <a class="side-dropdown-item 
            {% if request.endpoint == 'admin_viewtasks' %}active{% endif %}"
             href="{{ url_for('admin_viewtasks') }}">View All Tasks</a>

          <a class="side-dropdown-item 
            {% if request.endpoint == 'admin_submit_task' %}active{% endif %}"
             href="{{ url_for('admin_submit_task') }}">Submit Task</a>

         


          <a class="side-dropdown-item 
            {% if request.endpoint == 'admin_submitted_tasks' %}active{% endif %}"
             href="{{ url_for('admin_submitted_tasks') }}">Submitted Tasks</a>
           
          <!-- Employee and internTASKS DROPDOWN -->
          {% elif session['user_role'] in  ('employee','intern') %}
             {% if session['user_role'] =='employee' %}
                <a class="side-dropdown-item 
                {% if request.endpoint == 'employee_createtask' %}active{% endif %}"
                href="{{ url_for('employee_createtask') }}">Create Tasks</a>
            {% endif %}
           
            <a class="side-dropdown-item 
            {% if request.endpoint == 'employee_submit_task' %}active{% endif %}"
             href="{{ url_for('employee_submit_task') }}">Submit Tasks</a>

            <a class="side-dropdown-item 
            {% if request.endpoint == 'employee_submitted_tasks' %}active{% endif %}"
             href="{{ url_for('employee_submitted_tasks') }}">Submitted Tasks</a>

             <a class="side-dropdown-item 
            {% if request.endpoint == 'employee_assigned_tasks' %}active{% endif %}"
             href="{{ url_for('employee_assigned_tasks') }}">View Assigned Tasks</a>


        {% endif %}

      </div>
    </div>


    <div class="nav-divider"></div>


    <!-- SYSTEM ACCESS -->
    {% if session.get('user_role') in ['superadmin','head'] %}
      <a href="{{ url_for('systemaccess') }}"
         class="nav-link1 {% if request.endpoint == 'systemaccess' %}active{% endif %}">
        <i class="fas fa-users-cog"></i>
        <span>System Access</span>
      </a>
    {% endif %}


    <!-- PROFILE -->
    {% if session['user_role'] == 'superadmin' %}
      <a href="{{ url_for('superadmin_profile') }}"
         class="nav-link1 {% if request.endpoint == 'superadmin_profile' %}active{% endif %}">

    {% elif session['user_role'] == 'head' %}
      <a href="{{ url_for('admin_profile') }}"
         class="nav-link1 {% if request.endpoint == 'admin_profile' %}active{% endif %}">

     {% elif session['user_role'] in  ('employee','intern') %}
      <a href="{{ url_for('employee_profile') }}" 
         class="nav-link1 {% if request.endpoint == 'employee_profile' %}active{% endif %}">
    {% endif %}
        <i class="fas fa-user-circle"></i>
        <span>Profile</span>
    </a>

  </div>

  <div class="logout-section">
    <a href="/logout" class="nav-link1 logout-link">
      <i class="fas fa-sign-out-alt"></i>
      <span>Logout</span>
    </a>
  </div>
</nav>



<!-- ================= JS FIXES ================= -->
<script>
  // Toggle mobile sidebar
  function toggleMobileMenu() {
    const sidebar = document.getElementById("sidebar");
    const overlay = document.querySelector(".overlay");
    sidebar.classList.toggle("active");
    overlay.classList.toggle("active");
  }

  // Dropdown logic
  function toggleSideDropdown(element) {
    // Close others
    document.querySelectorAll(".side-dropdown").forEach(drop => {
      if (drop !== element) drop.classList.remove("active");
    });

    // Toggle current
    element.classList.toggle("active");
  }

  // Close sidebar when clicking outside on mobile
  document.addEventListener("click", function(event) {
    const sidebar = document.getElementById("sidebar");
    const btn = document.querySelector(".mobile-menu-btn");

    if (!sidebar.contains(event.target) && !btn.contains(event.target)) {
      sidebar.classList.remove("active");
      document.querySelector(".overlay").classList.remove("active");
    }
  });
</script>
